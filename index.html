<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Open Wear AI - Minimalist</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <style>
        :root {
            --bg-page: #ffffff;
            --text-main: #202124;
        }

        body {
            background-color: var(--bg-page);
            font-family: 'Comfortaa', cursive;
            font-weight: 300;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            margin: 0;
            color: var(--text-main);
        }

        .material-symbols-rounded {
            font-variation-settings: 'FILL' 0, 'wght' 200, 'GRAD' 0, 'opsz' 24;
            font-size: 20px;
        }

        /* Không gian chính với hình nền anime chính xác */
        .viewport {
            flex-grow: 1;
            position: relative;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            display: flex;
            align-items: center;
            justify-content: center;
            /* Đã cập nhật đúng link ảnh của cậu */
            background-image: url('https://cdn2.fptshop.com.vn/unsafe/800x0/hinh_nen_phong_canh_anime_13_4e4d3ce8d5.jpg');
        }

        .content-overlay {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 10;
        }

        .central-search-container {
            width: 100%;
            max-width: 600px;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 20;
        }

        .central-search {
            background: rgba(255, 255, 255, 0.85);
            height: 64px;
            border-radius: 32px;
            display: flex;
            align-items: center;
            padding: 0 8px 0 28px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(15px);
        }

        .central-search input {
            flex-grow: 1;
            border: none;
            outline: none;
            font-family: 'Comfortaa', cursive;
            font-size: 18px;
            background: transparent;
            color: #1a1a1a;
        }

        .search-btn {
            width: 48px;
            height: 48px;
            background: #202124;
            color: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        .search-btn:hover {
            transform: scale(1.05);
            background: #000;
        }

        .result-container {
            width: 100%;
            max-width: 850px;
            margin-top: 30px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
            pointer-events: none;
            max-height: 0;
            overflow: hidden;
            margin-bottom: 40px;
        }

        .result-container.show {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
            max-height: 70vh;
            overflow-y: auto;
        }

        .result-card {
            background: rgba(255, 255, 255, 0.92);
            backdrop-filter: blur(12px);
            border-radius: 32px;
            padding: 45px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            border: 1px solid rgba(255, 255, 255, 0.6);
        }

        .loader-dots {
            display: flex;
            gap: 8px;
        }

        .dot {
            width: 8px;
            height: 8px;
            background: #202124;
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out both;
        }
        .dot:nth-child(1) { animation-delay: -0.32s; }
        .dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1.0); }
        }

        .reset-btn {
            position: absolute;
            top: 30px;
            right: 30px;
            background: rgba(255,255,255,0.85);
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 50;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .reset-btn.show { opacity: 1; }

        .result-container::-webkit-scrollbar {
            width: 6px;
        }
        .result-container::-webkit-scrollbar-thumb {
            background: rgba(0,0,0,0.1);
            border-radius: 3px;
        }

        /* Định dạng nội dung phản hồi thân thiện */
        .ai-text {
            font-size: 17px;
            line-height: 1.9;
            color: #2c3e50;
            font-weight: 300;
        }
        .ai-text p {
            margin-bottom: 22px;
            text-align: justify;
        }
    </style>
</head>
<body>

    <main class="viewport" id="bg-viewport">
        <div class="reset-btn" id="reset-btn" onclick="resetUI()">
            <span class="material-symbols-rounded">close</span>
        </div>

        <div class="content-overlay">
            <div class="central-search-container" id="search-wrapper">
                <div class="central-search">
                    <input type="text" id="search-input" placeholder="Tâm sự với tớ đi..." onkeydown="handleEnter(event)">
                    <div class="search-btn" onclick="performAISearch()">
                        <span class="material-symbols-rounded">arrow_forward</span>
                    </div>
                </div>
            </div>

            <div class="result-container" id="result-wrapper">
                <div class="result-card" id="ai-response-content">
                    <!-- Nội dung AI sẽ vào đây -->
                </div>
            </div>
        </div>
    </main>

    <script>
        const apiKey = "";

        async function performAISearch() {
            const query = document.getElementById('search-input').value;
            if (!query) return;

            const searchWrapper = document.getElementById('search-wrapper');
            const resultWrapper = document.getElementById('result-wrapper');
            const responseContent = document.getElementById('ai-response-content');
            const resetBtn = document.getElementById('reset-btn');

            searchWrapper.style.transform = "translateY(-20px) scale(0.95)";
            
            responseContent.innerHTML = `
                <div class="flex items-center gap-4 text-gray-500">
                    <div class="loader-dots">
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                    </div>
                    <span>Đang lắng nghe cậu và tìm câu trả lời thật hay đây...</span>
                </div>
            `;
            resultWrapper.classList.add('show');
            resetBtn.classList.add('show');

            // System prompt để định hình tính cách người bạn thân
            const systemPrompt = "Cậu là một người bạn thân thiết, cực kỳ am hiểu và tâm lý. " +
                                 "Hãy trả lời bằng tiếng Việt, phong cách cực kỳ chi tiết, kiến thức chuyên sâu như một chuyên gia nhưng giọng văn lại vô cùng thân thiện, gần gũi như đang trò chuyện trực tiếp. " +
                                 "Câu trả lời cần dài và đầy đủ hơn cả Wikipedia nếu có thể. " +
                                 "TUYỆT ĐỐI KHÔNG sử dụng các ký tự đặc biệt của Markdown như **, #, hoặc danh sách có dấu gạch ngang lạ mắt. " +
                                 "Hãy dùng ngôn ngữ tự nhiên hoàn toàn, xuống dòng giữa các đoạn văn để dễ đọc.";

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: query }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] }
                    })
                });
                
                const data = await response.json();
                let text = data.candidates?.[0]?.content?.parts?.[0]?.text || "Ôi tớ xin lỗi, hình như đường truyền có chút vấn đề, cậu thử hỏi lại tớ nhé!";
                
                // Loại bỏ sạch sẽ các ký tự Markdown nếu có
                text = text.replace(/\*\*/g, '').replace(/###/g, '').replace(/##/g, '').replace(/\*/g, '').replace(/^- /gm, '');

                responseContent.innerHTML = `
                    <div class="ai-text">
                        ${text.split('\n').filter(p => p.trim() !== '').map(p => `<p>${p.trim()}</p>`).join('')}
                    </div>
                `;
            } catch (e) {
                responseContent.innerHTML = `<div class="text-red-500">Ôi, mạng mẽo chán quá, tớ chưa kịp trả lời cho cậu rồi. Cậu thử lại giúp tớ nhé!</div>`;
            }
        }

        function handleEnter(e) {
            if (e.key === 'Enter') performAISearch();
        }

        function resetUI() {
            document.getElementById('search-input').value = "";
            document.getElementById('search-wrapper').style.transform = "translateY(0) scale(1)";
            document.getElementById('result-wrapper').classList.remove('show');
            document.getElementById('reset-btn').classList.remove('show');
        }
    </script>
</body>
</html>
